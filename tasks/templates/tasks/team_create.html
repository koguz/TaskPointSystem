{% extends "tasks/base.html" %}
{% load static %}
{% block layout_mode %}three{% endblock %}

{% block breadcrumbs %}
<div class="tps-view-head">
  <p class="tps-view-kicker">Lecturer Workspace</p>
  <h1 class="tps-view-title">Create Teams</h1>
  <p class="tps-view-subtitle">{{ course }}</p>
</div>
{% endblock %}

{% block left_content %}
<section class="tps-section">
  <div class="tps-section-header">
    <h2 class="tps-section-title">Input Format</h2>
  </div>
  <div class="tps-section-body small">
    <p>Paste student rows exactly as copied from your source list (tab-separated fields).</p>
    <p>Optional extra columns are supported after last name: <code>Section</code> (integer) and <code>Description</code> (text).</p>
    <p class="mb-0">If extra columns are not provided, defaults from the form are used for all pasted students.</p>
  </div>
</section>

<section class="tps-section">
  <div class="tps-section-header">
    <h2 class="tps-section-title">Current Assignments</h2>
  </div>
  <div class="tps-section-body">
    <div class="table-responsive">
      <table class="table tps-table-clean table-sm mb-0">
        <tbody>
          {% for key, value in t_d.items %}
            {% for dev in value %}
            <tr>
              <td>{{ dev.getName }}</td>
              <td class="text-muted">{{ key }}</td>
            </tr>
            {% endfor %}
          {% empty %}
          <tr>
            <td class="text-muted">No assignments yet.</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</section>
{% endblock %}

{% block main_content %}
<section class="tps-section">
  <div class="tps-section-header">
    <h2 class="tps-section-title">Generate Random Teams</h2>
  </div>
  <div class="tps-section-body">
    <form action="{% url 'create_team' course.pk %}" method="post" class="tps-form-grid">
      {% csrf_token %}
      <div>
        <label for="team-size" class="form-label">Team Size</label>
        <input id="team-size" type="number" min="1" name="team_size" value="4" class="form-control" />
      </div>
      <div>
        <label for="default-section-auto" class="form-label">Default Section</label>
        <input id="default-section-auto" type="number" min="1" name="default_section" value="1" class="form-control" />
      </div>
      <div>
        <label for="default-section-description-auto" class="form-label">Default Section Description (Optional)</label>
        <input id="default-section-description-auto" type="text" name="default_section_description" class="form-control" placeholder="e.g. Monday mornings" />
      </div>
      <div>
        <label for="stdlist-auto" class="form-label">Student List</label>
        <textarea id="stdlist-auto" rows="14" name="stdlist" class="form-control" placeholder="Paste student list here..."></textarea>
      </div>
      <div class="form-actions">
        <button name="auto" type="submit" class="btn btn-primary">Generate Random Teams</button>
      </div>
    </form>
  </div>
</section>
{% endblock %}

{% block right_content %}
<section class="tps-section">
  <div class="tps-section-header">
    <h2 class="tps-section-title">Manual Team Creation</h2>
  </div>
  <div class="tps-section-body">
    <form action="{% url 'create_team' course.pk %}" method="post" class="tps-form-grid">
      {% csrf_token %}
      <div>
        <label for="default-section-manual" class="form-label">Default Section</label>
        <input id="default-section-manual" type="number" min="1" name="default_section" value="1" class="form-control" />
      </div>
      <div>
        <label for="default-section-description-manual" class="form-label">Default Section Description (Optional)</label>
        <input id="default-section-description-manual" type="text" name="default_section_description" class="form-control" placeholder="e.g. Monday mornings" />
      </div>
      <div>
        <label for="stdlist-manual" class="form-label">Student List</label>
        <textarea id="stdlist-manual" rows="14" name="stdlist" class="form-control" placeholder="Paste one team's members..."></textarea>
      </div>
      <div class="form-actions">
        <button name="manuel" type="submit" class="btn btn-outline-primary">Generate Teams Manually</button>
      </div>
    </form>
  </div>
</section>
{% endblock %}
